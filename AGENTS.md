# Repository Guidelines

## Project Structure & Module Organization
- Source: `src/` (collectors, analyzers, formatters, utils, types). Entry: `src/index.ts`.
- Build output: `dist/` (generated by TypeScript).
- Tests: `tests/` (e.g., `html-formatter.test.ts`).
- Docs & examples: `docs/`, `examples/`.
- Scripts: `scripts/` (e.g., `test-structure.js`).

## Build, Test, and Development Commands
- `npm install` — install dependencies.
- `npm run dev` — run CLI via ts-node for local development.
- `npm run build` — compile TypeScript to `dist/`.
- `npm start` — run compiled CLI (`dist/index.js`).
- `npm run test:unit` — run unit tests with ts-node.
- `npm run test:structure` — verify expected files exist in `dist/`.
- Helpful flags (pass after `--`): `--hours`, `--namespace`, `--format {console|json|markdown|html}`, `--output <file>`, `--kubeconfig <path>`.
- Test-mode: set `K8S_SUMMARY_SKIP_CONNECT=1` to bypass cluster calls.

## Coding Style & Naming Conventions
- Language: TypeScript (`strict` per `tsconfig.json`).
- Indentation: 2 spaces; line endings: LF.
- Filenames: kebab-case for files (`k8s-client.ts`), plural folders for modules (`collectors/`, `formatters/`).
- Types/interfaces: PascalCase; variables/functions: camelCase; constants: UPPER_SNAKE_CASE.
- Prefer small, focused modules; keep side effects in `src/index.ts` and pure logic in submodules.

## Testing Guidelines
- Framework: Node assert with ts-node; place tests in `tests/` named `*.test.ts`.
- Run: `npm run test:unit` (unit) and `npm run test:structure` (artifact check).
- Use `K8S_SUMMARY_SKIP_CONNECT=1` for formatter/analyzer tests to avoid real cluster access.
- Include sample inputs/outputs and cover common failure reasons (e.g., CrashLoopBackOff, OOMKilled).

## Commit & Pull Request Guidelines
- Commit style: Conventional Commits encouraged (e.g., `feat:`, `fix:`, `docs:`, `refactor:`). Example: `docs: update Chinese usage guide`.
- PRs must include: clear description, linked issues, test plan, and sample CLI output (console/markdown/html). Note any kubeconfig or cluster version assumptions.
- Do not commit secrets or kubeconfigs. Keep changes minimal and scoped.

## Security & Configuration Tips
- Prefer passing `--kubeconfig` or rely on default kubeconfig discovery; never hardcode credentials.
- Handle errors with actionable messages and avoid `process.exit` in library code (OK in CLI entry).

## Agent-Specific Notes
- Follow these rules for any automated edits. Use existing scripts, avoid unrelated refactors, and keep the public CLI interface stable.
